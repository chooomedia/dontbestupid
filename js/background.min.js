function addVisit(url){let promise;return new Promise(finished=>{chrome.storage.sync.get(url,function(pageMetadata){pageMetadata[url]?pageMetadata[url].timestamps.push(new Date):(pageMetadata={})[url]={question:null,highestPointAnswer:null,acceptedAnswer:null,timestamps:[new Date]},chrome.storage.sync.set(pageMetadata);let newVisitCount=pageMetadata[url].timestamps.length;finished(newVisitCount)})})}function displayYoureStupidMesssage(){chrome.tabs.query({active:!0,currentWindow:!0},function(tabs){chrome.tabs.executeScript(tabs[0].id,{file:"js/overlay.js"})})}chrome.storage.sync.get("_settings",function(settingsObj){settingsObj._settings||chrome.storage.sync.set({_settings:{isEnabled:!0,mode:"count",intervall:3}})}),chrome.webNavigation.onCommitted.addListener(function(data){0==data.frameId&&chrome.storage.sync.get("_settings",async function(settingsObj){let storedIsEnabledValue=settingsObj._settings.isEnabled,storedMode=settingsObj._settings.mode,intervall=settingsObj._settings.intervall;if(!storedIsEnabledValue&&storedMode)return;if(!data.url.startsWith("https://stackoverflow.com/"))return;let visitCount=await addVisit(data.url);visitCount>0&&chrome.browserAction.setBadgeText({text:visitCount.toString()}),visitCount>parseInt(intervall)&&(console.log("Stay Focused - agianst internet dementia :-)"),displayYoureStupidMesssage())})});